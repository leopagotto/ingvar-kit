# üöÄ ENHANCED LEO KIT: Adding Spec-Driven AI Code Generation

**Proposal:** Integrate spec-kit's Spec-Driven Development (SDD) methodology into LEO kit for **automated code generation alongside workflow governance**.

---

## üìä Comparison: LEO Kit vs Spec-Kit

| Feature                     | LEO Kit (Current) | Spec-Kit (GitHub) | **Enhanced LEO** |
| --------------------------- | ----------------- | ----------------- | ---------------- |
| **Workflow Governance**     | ‚úÖ Strong         | ‚ùå None           | ‚úÖ Strong        |
| **AI Code Generation**      | ‚ùå No             | ‚úÖ Yes            | ‚úÖ **YES**       |
| **Multi-Agent Routing**     | ‚úÖ 6 agents       | ‚ùå None           | ‚úÖ Enhanced      |
| **Spec-Driven Development** | ‚ùå No             | ‚úÖ Yes            | ‚úÖ **YES**       |
| **Team Coordination**       | ‚úÖ Strong         | ‚ùå Minimal        | ‚úÖ Strong        |
| **GitHub Integration**      | ‚úÖ Deep           | ‚ö†Ô∏è Basic          | ‚úÖ Deep          |
| **Automatic Code Gen**      | ‚ùå No             | ‚úÖ Yes            | ‚úÖ **YES**       |
| **Process Enforcement**     | ‚úÖ Yes            | ‚ö†Ô∏è Optional       | ‚úÖ Yes           |
| **AI Agent Support**        | 6 specialized     | 13+ generic       | ‚úÖ **Both**      |
| **Technology Stack**        | Node.js/npm       | Python/uv         | ‚úÖ Both          |

---

## üéØ The Vision: Enhanced LEO Kit

```
User Requirement
    ‚Üì
leo issue create (auto-create GitHub issue)
    ‚Üì
/leo.constitution (define project principles - NEW!)
    ‚Üì
/leo.specify (write technical spec - NEW!)
    ‚Üì
Orchestrator Routes to Specialist
    ‚Üì
/leo.plan + /leo.tasks (architect + break down - NEW!)
    ‚Üì
/leo.implement (AI generates code - NEW!)
    ‚Üì
PR Review + Quality Check
    ‚Üì
Deploy
```

---

## üèóÔ∏è Architecture: Enhanced LEO Kit

### Layer 1: Governance (LEO Kit - Existing ‚úÖ)

- Issue creation & tracking
- Multi-agent routing
- Workflow enforcement
- Team coordination

### Layer 2: Specification (Spec-Kit - NEW üÜï)

- Constitution creation (principles)
- Specification writing
- Technical planning
- Task breakdown

### Layer 3: AI Code Generation (Hybrid - NEW üÜï)

- Automated code generation from specs
- Quality analysis & validation
- Implementation tracking
- Real-time updates

---

## üîß Proposed Commands: Enhanced LEO Kit

### Phase 1: Governance (Existing)

```bash
leo issue create "Build user dashboard"
leo status
leo config
```

### Phase 2: Specification (NEW - Spec-Kit Integration)

```bash
leo spec init my-feature                    # Initialize spec project
leo spec constitution                       # Create project principles
leo spec specify "what to build"            # Write spec
leo spec plan "tech stack details"          # Plan implementation
leo spec tasks                              # Break into tasks
leo spec analyze                            # Validate spec
```

### Phase 3: AI Code Generation (NEW - Hybrid)

```bash
leo spec implement                          # Generate code from spec
leo spec checklist                          # Create quality checklist
leo spec review                             # Review generated code
```

### Phase 4: Deployment (Enhanced)

```bash
leo spec deploy                             # Deploy generated code
leo spec status                             # Show progress
leo spec report                             # Generate report
```

---

## üìÅ File Structure: Enhanced LEO Kit

```
leo-workflow-kit/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ agents/                             (existing)
‚îÇ   ‚îú‚îÄ‚îÄ commands/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ issue.js                        (existing)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ status.js                       (existing)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spec.js                         (NEW - spec commands)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ spec/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ constitution.js             (NEW)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ specify.js                  (NEW)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ plan.js                     (NEW)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ tasks.js                    (NEW)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ implement.js                (NEW - AI code gen!)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ analyze.js                  (NEW)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ checklist.js                (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ generators/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ web-plugin-generator.js         (existing)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spec-generator.js               (NEW)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ai-code-generator.js            (NEW - uses Claude/Copilot)
‚îÇ   ‚îú‚îÄ‚îÄ spec/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ constitution.js                 (NEW - principles management)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ specification.js                (NEW - spec management)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ analyzer.js                     (NEW - consistency checker)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validator.js                    (NEW - quality validator)
‚îÇ   ‚îî‚îÄ‚îÄ ai/
‚îÇ       ‚îú‚îÄ‚îÄ code-generation.js              (NEW - AI integration)
‚îÇ       ‚îú‚îÄ‚îÄ providers/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ claude.js                   (NEW)
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ copilot.js                  (NEW)
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ gemini.js                   (NEW)
‚îÇ       ‚îî‚îÄ‚îÄ utils/
‚îÇ           ‚îú‚îÄ‚îÄ prompt-builder.js           (NEW)
‚îÇ           ‚îî‚îÄ‚îÄ code-formatter.js           (NEW)
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ spec/                               (NEW)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ constitution.template.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ specification.template.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plan.template.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ checklist.template.md
‚îÇ   ‚îî‚îÄ‚îÄ generated/                          (NEW)
‚îÇ       ‚îî‚îÄ‚îÄ [auto-generated code]
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ spec-driven-development.md          (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ constitution-guide.md               (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ specification-writing.md            (NEW)
‚îÇ   ‚îú‚îÄ‚îÄ ai-code-generation.md               (NEW)
‚îÇ   ‚îî‚îÄ‚îÄ integration-guide.md                (NEW)
‚îú‚îÄ‚îÄ .leorc.json                             (updated)
‚îî‚îÄ‚îÄ .specrc.json                            (NEW - spec config)
```

---

## üöÄ Implementation Plan: Phase-by-Phase

### Phase 1: Spec Foundation (Week 1)

- [ ] Create spec command module
- [ ] Build constitution management
- [ ] Create spec templates
- [ ] Implement specification storage
- [ ] Add spec commands to CLI

**Output:** `leo spec init`, `leo spec constitution`

### Phase 2: Planning & Analysis (Week 2)

- [ ] Build planning tools
- [ ] Create task generator
- [ ] Implement spec analyzer
- [ ] Add validation logic
- [ ] Create quality checklists

**Output:** `leo spec plan`, `leo spec tasks`, `leo spec analyze`

### Phase 3: AI Code Generation (Week 3-4)

- [ ] Integrate Claude API (primary)
- [ ] Add Copilot support
- [ ] Build prompt engineering system
- [ ] Create code formatters
- [ ] Implement code review system

**Output:** `leo spec implement`, `leo spec checklist`

### Phase 4: Integration & Deployment (Week 5)

- [ ] Connect to existing LEO agents
- [ ] Update workflow orchestrator
- [ ] Add deployment commands
- [ ] Create monitoring/status
- [ ] Comprehensive documentation

**Output:** Complete enhanced LEO kit

---

## üíª Code Example: AI Code Generation

### New Command: `leo spec implement`

```javascript
// lib/commands/spec/implement.js

const { AICodeGenerator } = require("../../ai/code-generation");
const { Specification } = require("../../spec/specification");
const { Analyzer } = require("../../spec/analyzer");

class ImplementCommand {
  static async execute(options = {}) {
    try {
      console.log(chalk.cyan.bold("\nü§ñ AI Code Generation\n"));

      // 1. Load specification
      const spec = await Specification.load();
      if (!spec) {
        throw new Error("No specification found. Run: leo spec specify");
      }

      // 2. Analyze spec
      console.log(chalk.gray("Analyzing specification..."));
      const analysis = await Analyzer.analyze(spec);

      if (analysis.issues.length > 0) {
        console.warn(
          chalk.yellow(`‚ö†Ô∏è  Issues found:\n${analysis.issues.join("\n")}`)
        );
      }

      // 3. Select AI provider
      const provider = options.ai || "claude";
      console.log(chalk.gray(`Using ${provider} for code generation...`));

      // 4. Generate code
      const generator = new AICodeGenerator(provider);
      const generatedCode = await generator.generateFromSpec(spec, {
        constitution: spec.constitution,
        plan: spec.plan,
        tasks: spec.tasks,
      });

      // 5. Format and save
      await this._saveGeneratedCode(generatedCode);

      console.log(chalk.green(`‚úÖ Code generated successfully!\n`));
      console.log(chalk.cyan("Next steps:"));
      console.log(`  1. Review generated code: leo spec review`);
      console.log(`  2. Run checklist: leo spec checklist`);
      console.log(`  3. Deploy: leo spec deploy\n`);
    } catch (error) {
      console.error(chalk.red(`‚ùå Implementation failed: ${error.message}\n`));
    }
  }

  static async _saveGeneratedCode(code) {
    const fs = require("fs").promises;
    const path = require("path");

    const outputDir = path.join(process.cwd(), ".leo/generated");
    await fs.mkdir(outputDir, { recursive: true });

    for (const [filename, content] of Object.entries(code)) {
      const filepath = path.join(outputDir, filename);
      await fs.mkdir(path.dirname(filepath), { recursive: true });
      await fs.writeFile(filepath, content);
    }
  }
}

module.exports = ImplementCommand;
```

### AI Code Generator: Claude Integration

```javascript
// lib/ai/providers/claude.js

const Anthropic = require("@anthropic-ai/sdk");

class ClaudeProvider {
  constructor(apiKey) {
    this.client = new Anthropic({
      apiKey: apiKey || process.env.ANTHROPIC_API_KEY,
    });
  }

  async generateCode(prompt, spec) {
    try {
      const message = await this.client.messages.create({
        model: "claude-3-5-sonnet-20241022",
        max_tokens: 4096,
        system: this._buildSystemPrompt(spec),
        messages: [
          {
            role: "user",
            content: prompt,
          },
        ],
      });

      return this._parseGeneratedCode(message.content[0].text);
    } catch (error) {
      throw new Error(`Claude API error: ${error.message}`);
    }
  }

  _buildSystemPrompt(spec) {
    return `You are an expert code generator. Your task is to generate production-ready code based on specifications.

Constitution (Project Principles):
${spec.constitution}

Technical Plan:
${spec.plan}

Requirements:
- Follow the constitution principles
- Generate complete, working code
- Include error handling
- Add comments for complex logic
- Follow best practices
- Generate all necessary files

Output Format:
Generate code as a JSON object with filenames as keys and code content as values.
Example: {
  "src/main.js": "// code here",
  "src/utils.js": "// code here"
}`;
  }

  _parseGeneratedCode(responseText) {
    // Extract JSON from markdown code blocks or raw JSON
    const jsonMatch = responseText.match(/\{[\s\S]*\}/);
    if (!jsonMatch) {
      throw new Error("Could not parse generated code from response");
    }
    return JSON.parse(jsonMatch[0]);
  }
}

module.exports = ClaudeProvider;
```

---

## üéØ Key Features: Enhanced LEO Kit

### 1. Specification-Driven Development

```bash
leo spec init my-feature
leo spec constitution                    # Define principles
leo spec specify "Build X"              # Write requirement
leo spec plan "Use React + Node"        # Plan architecture
leo spec tasks                          # Break into tasks
leo spec analyze                        # Validate consistency
```

### 2. Automated Code Generation

```bash
leo spec implement                      # Claude generates code
# Generates:
# - src/components/
# - src/utils/
# - src/styles/
# - package.json
# - tests/
```

### 3. Quality Validation

```bash
leo spec checklist                      # Generate quality checklist
leo spec review                         # Review generated code
leo spec analyze                        # Check consistency
```

### 4. Integrated Deployment

```bash
leo spec deploy                         # Deploy to production
leo spec status                         # Show progress
leo spec report                         # Generate report
```

---

## üìä Benefits: Enhanced LEO Kit

### For Teams

‚úÖ Governance + AI = Best of both worlds
‚úÖ Spec-driven ensures clarity before code
‚úÖ Multi-agent routing for expertise
‚úÖ Automated quality checks
‚úÖ Complete audit trail

### For Developers

‚úÖ AI writes boilerplate automatically
‚úÖ Focus on complex logic, not scaffolding
‚úÖ 10x faster feature development
‚úÖ Consistent code style
‚úÖ Built-in best practices

### For Projects

‚úÖ Professional code quality
‚úÖ Reduced bugs (spec validation)
‚úÖ Faster time-to-market
‚úÖ Maintainable codebase
‚úÖ Clear specifications

---

## üîå Installation: Enhanced LEO Kit

### Current State

```bash
npm install leo-workflow-kit
leo config init
leo issue create "My task"
```

### Enhanced State (After Implementation)

```bash
npm install leo-workflow-kit --latest

# New: Specification-driven workflow
leo spec init my-feature
leo spec constitution
leo spec specify "Build user dashboard"
leo spec plan "React + Express + MongoDB"
leo spec tasks
leo spec implement                      # ‚Üê AI generates code!
leo spec checklist
leo spec deploy

# Existing: Governance workflow
leo issue create "Deploy to production"
leo status
leo config
```

---

## üìà Timeline: Enhanced LEO Kit

```
Week 1: Spec Foundation
‚îú‚îÄ Spec command module
‚îú‚îÄ Constitution management
‚îú‚îÄ Templates
‚îî‚îÄ CLI integration

Week 2: Planning & Analysis
‚îú‚îÄ Planning tools
‚îú‚îÄ Task generator
‚îú‚îÄ Spec analyzer
‚îî‚îÄ Quality validation

Week 3-4: AI Code Generation
‚îú‚îÄ Claude integration
‚îú‚îÄ Copilot support
‚îú‚îÄ Prompt engineering
‚îî‚îÄ Code formatting

Week 5: Integration & Launch
‚îú‚îÄ Multi-agent routing
‚îú‚îÄ Deployment commands
‚îú‚îÄ Documentation
‚îî‚îÄ Release

Target: Mid-November 2025
```

---

## üéì Learning from Spec-Kit

### What to Adopt ‚úÖ

1. **Spec-Driven Methodology** - Write spec before code
2. **Multi-Step Refinement** - Constitution ‚Üí Spec ‚Üí Plan ‚Üí Tasks ‚Üí Code
3. **AI-Native Development** - AI generates, humans validate
4. **Quality Validation** - Built-in checklists and analysis
5. **Multi-Agent Support** - Claude, Copilot, Gemini, etc.

### What LEO Does Better ‚úÖ

1. **Team Governance** - Multi-agent orchestration
2. **Workflow Enforcement** - Process compliance
3. **GitHub Integration** - Labels, templates, project sync
4. **Existing CLI** - Proven, battle-tested
5. **Community Support** - Active ecosystem

### Combination = Superset

‚úÖ LEO's governance
‚úÖ Spec-kit's AI generation
‚úÖ Best of both worlds

---

## üöÄ Next Steps

### Option 1: Implement Now

Start building enhanced LEO kit with spec-driven AI generation this week.

### Option 2: Pilot Project

Create `/leo spec` commands first as a pilot, measure results, then scale.

### Option 3: Contribute to Spec-Kit

Propose LEO integration to spec-kit maintainers for official support.

---

## ‚úÖ Decision Point

**Would you like to:**

1. **Build Enhanced LEO Kit** - Add spec-driven AI code generation to leo-workflow-kit
2. **Integrate Spec-Kit** - Use spec-kit alongside leo-workflow-kit
3. **Fork & Enhance** - Create "leo-spec-kit" combining both
4. **Something Else** - Different approach

---

_Analysis Complete: Ready to implement enhanced LEO kit with Spec-Driven Development + AI Code Generation_
